# recipeum

# Предназначение системы

Web-приложение recipeum предназначено для ведения книги рецептов блюд.

# Функциональные требования

1. Ввод информации о рецепте. В состав информации о рецепте должно входить следующее:  
   1. уникальный идентификатор рецепта \- обязательно. Генерируется системой;  
   2. наименование рецепта \- обязательно;  
   3. список ингредиентов, необходимых для приготовления блюда \- обязательно. Список ингредиентов структурирован, каждый ингредиент \- отдельная позиция с названием и количеством (будь то граммы, штуки или объем). Количество ингредиентов в рецепте \- до 40;  
   4. описание приготовления блюда \- обязательно. Включает текст, может содержать картинки и видеоматериалы. Текст описания представляется пользователю в формате html;   
   5. ссылку на web-сайт / ресурс, послуживший источником заполнения информации о рецепте \- если таковой имеется;  
   6. все медиафайлы, на которые упоминаются ссылки, должны сохраняться в системе;  
   7. дата внесения рецепта в систему \- обязательно;  
   8. тип блюда по заранее подготовленной основной классификации \- обязательно. Основная классификация может выглядеть, например, так:: супы, салаты, мясные блюда, рыбные блюда, пироги, пицца, каши, десерты, торты и т.д.;  
   9. произвольное количество тегов, которые пользователь системы может назначить на каждый рецепт. Сочетания тег\-рецепт уникально;  
2. Консистентное хранение информации о рецептах.  
3. Возможность изменения состава любых данных рецепта, кроме идентификаторов. Идентификаторы назначаются системой.  
4. Фильтрация списка рецептов по любому сочетанию свойств: по типу блюда, по тегам, по текстовым фрагментам в наименовании или описании, по ингредиентам, по дате внесения, по ссылке.

# Нефункциональные требования к системе:

1. Информация доступна для любого пользователя без ограничения функционала. Идентификация и авторизация не используются.
3. Производительность: система должна обеспечивать скорость отклика при любой операции (поиск, ввод блок информации) не более чем за полсекунды, включая отработку и на сервере, и в браузере. В качестве типовой конфигурации, имеем один сервер  с 8 гигабайтами оперативной памяти и 4-ядерным процессором. Система должна обеспечивать заявленную производительность при обработке данных объема около 10000 рецептов;

# Архитектура

1. Трехзвенная архитектура, состоящая из базы данных, серверного приложения и приложения-клиента, выполняющегося в web-браузере;
2. Клиентское приложение (frontend) взаимодействует с серверным приложением (backend) по rest api; 
3. backend системы должен быть разработан на языке программирования python;  
4. Обеспечить уникальный сквозной трекинг всех входящих запросов;
5. Обеспечить ведение журнала работы всех компонентов с фиксацией уровня "тяжести" записи в журнал: info, debug, warning, error;
6. Обеспечить механизмы мониторинга состояния системы: healthchecks, readyness, liveness;
7. Обеспечить механизмы интеграции с prometheus для сбора метрик, например: среднее число запросов за период времени, среднее время обработки за период времени;
8. Необходимо использовать следующие библиотеки:  
   1. SQL Alchemy и alembic для работы с СУБД;  
   2. fast api для backend;  
   3. react для frontend;  
9. В качестве базы данных использовать СУБД PostgreSQL; 
10. Предполагается развертывание в docker-контейнерах. Необходимо включить в репозиторий исходников файла docker-compose.yml;  
11. Соответствующие настройки работы системы вынести в переменные окружения, задаваемые при развертывании в docker-compose.yaml; 
12. Обеспечить graceful shutdown для backend и frontend;
13. Обеспечить retry при вызове методов backend, и при потере соединения между backaned и database;
14. Обеспечить в backend пул соединений для оптимизации работы с database;  

# Данные
  
1. Схема данных содержит следующие таблицы:
- recipes: рецепты;
- ingredients: ингредиенты рецептов;
- tags: теги рецептов;
- dish_types: справочник типов блюд;
2. Медиаматериалы хранятся в файловой системе в виде файлов, ссылки на полные пути до файлов имеются в поле recipes.description, которое имеет формат html. Каталог медиа файлов настраивается;  

 # Документация

1. В состав репозитория с кодом должен входить документ с описанием API;  
2. В состав репозитория с кодом должна входить инструкция по развертыванию с указанием конфигурационных параметров и их назначения;

# GUI

## Главный экран приложения 

В нем размещены элементы управления для фильтрации рецептов и навигации по ним, а также отображения результата фильтрации. 

Найденные рецепты можно сортировать по атрибутам. 

Чтобы избежать загрузки в браузер слишком большого количества объектов, использовать пагинацию. 

На этом же экране, каждый рецепт можно удалить, либо вызвать экран для его редактирования. 

На этом же экране можно вызвать экран для ввода нового рецепта.

На этом же экране можно вызвать экран для ведения типов блюд.

## Экран для ввода рецепта

Предназначен для ввода нового рецепта, либо редактирования свойств имеющегося. 

При внесении нового рецепта программа генерирует уникальный идентификатор, а также дату внесения рецепта в систему. В дальнейшем, эти значения не подлежат модификации.

Для указания типа блюда используется выпадающий список типов, может быть выбрано только одно значение. Предусмотреть кнопку для обновления (начитывания из backend) списка типов блюд.

Для ввода набора ингредиентов используется расширяемый список записей со следующими атрибутами: 

- название ингредиента выбирается из списка ранее введенных значений, либо, если не устраивает, принимается новое значение, введенное пользователем;  
- количество единиц измерения ингредиента;  
- единица измерения ингредиента выбирается из выпадающего списка предустановленных единиц измерения: штука, грамм, килограмм, литр, столовая ложка, чайная ложка, щепотка, стакан, пучок. Выпадающий список отсортирован по алфавиту;

При вводе или редактировании описания рецепта, предусмотреть режим перетаскивания картинки или видеофайла в предварительно обозначенную позицию в тексте описания. 

Для ввода тегов используется адаптивно подстраивающийся список ранее введенных тегов, по мере набора букв при вводе. Допускается назначение любого количества тегов на рецепт. Допускается удаление тегов из списка назначенных на рецепт при его редактировании. Предусмотреть кнопку для обновления обновления (начитывания из backend) списка тегов.

Этот же экран, но с частично или полностью заполненными элементами информации, используется для редактирования рецепта;

## Экран для ведения типов блюд

Содержит список типов блюд, а также кнопки для редактирования, добавления и удаления типов блюд в этом списке. 
Экран для ведения типов блюд вызывается явно из главного экрана.
